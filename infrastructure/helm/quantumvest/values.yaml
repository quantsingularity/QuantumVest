# Default values for QuantumVest Helm Chart
# This is a YAML-formatted file.

# Global configuration
global:
    imageRegistry: 'ghcr.io'
    imagePullSecrets:
        - name: ghcr-secret
    storageClass: 'gp3-encrypted'

# Application metadata
appName: quantumvest
namespace: quantumvest-production
environment: production

# Image configuration
image:
    registry: ghcr.io
    repository: quantumvest
    tag: 'latest'
    pullPolicy: IfNotPresent
    pullSecrets:
        - name: ghcr-secret

# Backend service configuration
backend:
    enabled: true
    name: backend
    replicas: 3

    image:
        repository: ghcr.io/quantumvest/backend
        tag: '1.0.0'
        pullPolicy: IfNotPresent

    containerPort: 8080

    resources:
        limits:
            cpu: '2000m'
            memory: '4Gi'
            storage: '2Gi'
        requests:
            cpu: '1000m'
            memory: '2Gi'
            storage: '1Gi'

    autoscaling:
        enabled: true
        minReplicas: 3
        maxReplicas: 20
        targetCPUUtilizationPercentage: 70
        targetMemoryUtilizationPercentage: 80

    deployment:
        strategy: RollingUpdate
        maxSurge: '25%'
        maxUnavailable: '25%'

    probes:
        liveness:
            initialDelaySeconds: 60
            periodSeconds: 30
            timeoutSeconds: 10
            failureThreshold: 3
        readiness:
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 3
        startup:
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 30

    service:
        type: ClusterIP
        port: 80
        targetPort: 8080
        annotations:
            prometheus.io/scrape: 'true'
            prometheus.io/port: '9090'
            prometheus.io/path: '/metrics'

    metrics:
        enabled: true
        port: 9090
        path: /metrics

    logLevel: 'info'
    terminationGracePeriodSeconds: 30

# Frontend service configuration
frontend:
    enabled: true
    name: frontend
    replicas: 2

    image:
        repository: ghcr.io/quantumvest/frontend
        tag: '1.0.0'
        pullPolicy: IfNotPresent

    containerPort: 3000

    resources:
        limits:
            cpu: '1000m'
            memory: '2Gi'
            storage: '1Gi'
        requests:
            cpu: '500m'
            memory: '1Gi'
            storage: '500Mi'

    autoscaling:
        enabled: true
        minReplicas: 2
        maxReplicas: 10
        targetCPUUtilizationPercentage: 70

    service:
        type: ClusterIP
        port: 80
        targetPort: 3000

# Analytics service configuration
analytics:
    enabled: true
    name: analytics
    replicas: 2

    image:
        repository: ghcr.io/quantumvest/analytics
        tag: '1.0.0'
        pullPolicy: IfNotPresent

    containerPort: 8081

    resources:
        limits:
            cpu: '2000m'
            memory: '8Gi'
            storage: '5Gi'
        requests:
            cpu: '1000m'
            memory: '4Gi'
            storage: '2Gi'

    service:
        type: ClusterIP
        port: 80
        targetPort: 8081

# Database configuration
postgresql:
    enabled: true
    auth:
        postgresPassword: '' # Set via secret
        username: quantumvest
        password: '' # Set via secret
        database: quantumvest

    architecture: replication
    primary:
        persistence:
            enabled: true
            size: 100Gi
            storageClass: 'gp3-encrypted'
        resources:
            limits:
                cpu: '4000m'
                memory: '8Gi'
            requests:
                cpu: '2000m'
                memory: '4Gi'

    readReplicas:
        replicaCount: 2
        persistence:
            enabled: true
            size: 100Gi
            storageClass: 'gp3-encrypted'
        resources:
            limits:
                cpu: '2000m'
                memory: '4Gi'
            requests:
                cpu: '1000m'
                memory: '2Gi'

    metrics:
        enabled: true
        serviceMonitor:
            enabled: true

    backup:
        enabled: true
        schedule: '0 2 * * *'
        retention: '30d'

# Redis configuration
redis:
    enabled: true
    architecture: replication
    auth:
        enabled: true
        password: '' # Set via secret

    master:
        persistence:
            enabled: true
            size: 20Gi
            storageClass: 'gp3-encrypted'
        resources:
            limits:
                cpu: '1000m'
                memory: '2Gi'
            requests:
                cpu: '500m'
                memory: '1Gi'

    replica:
        replicaCount: 2
        persistence:
            enabled: true
            size: 20Gi
            storageClass: 'gp3-encrypted'
        resources:
            limits:
                cpu: '500m'
                memory: '1Gi'
            requests:
                cpu: '250m'
                memory: '512Mi'

    metrics:
        enabled: true
        serviceMonitor:
            enabled: true

# Ingress configuration
ingress:
    enabled: true
    className: 'nginx'
    annotations:
        nginx.ingress.kubernetes.io/ssl-redirect: 'true'
        nginx.ingress.kubernetes.io/force-ssl-redirect: 'true'
        nginx.ingress.kubernetes.io/proxy-body-size: '50m'
        nginx.ingress.kubernetes.io/rate-limit: '100'
        nginx.ingress.kubernetes.io/rate-limit-window: '1m'
        cert-manager.io/cluster-issuer: 'letsencrypt-prod'
        nginx.ingress.kubernetes.io/configuration-snippet: |
            more_set_headers "X-Frame-Options: DENY";
            more_set_headers "X-Content-Type-Options: nosniff";
            more_set_headers "X-XSS-Protection: 1; mode=block";
            more_set_headers "Strict-Transport-Security: max-age=31536000; includeSubDomains";

    hosts:
        - host: quantumvest.com
          paths:
              - path: /
                pathType: Prefix
                service:
                    name: quantumvest-frontend
                    port: 80
              - path: /api
                pathType: Prefix
                service:
                    name: quantumvest-backend
                    port: 80
              - path: /analytics
                pathType: Prefix
                service:
                    name: quantumvest-analytics
                    port: 80

    tls:
        - secretName: quantumvest-tls
          hosts:
              - quantumvest.com

# Security configuration
security:
    podSecurityPolicy:
        enabled: true

    networkPolicy:
        enabled: true

    serviceAccount:
        create: true
        annotations: {}
        name: ''

    rbac:
        create: true

    securityContext:
        runAsNonRoot: true
        runAsUser: 10001
        runAsGroup: 10001
        fsGroup: 10001

    podSecurityContext:
        seccompProfile:
            type: RuntimeDefault

# Secrets management
secrets:
    create: true
    annotations:
        vault.hashicorp.com/agent-inject: 'true'
        vault.hashicorp.com/role: 'quantumvest'

# ConfigMaps
configMaps:
    create: true

# Monitoring configuration
monitoring:
    prometheus:
        enabled: true
        serviceMonitor:
            enabled: true
            interval: 30s
            scrapeTimeout: 10s

    grafana:
        enabled: true
        adminPassword: '' # Set via secret

    alerts:
        enabled: true

# Logging configuration
logging:
    elasticsearch:
        enabled: true

    logstash:
        enabled: true

    kibana:
        enabled: true

    filebeat:
        enabled: true

# Backup configuration
backup:
    enabled: true
    schedule: '0 2 * * *'
    retention: '30d'
    storage:
        type: 's3'
        bucket: 'quantumvest-backups'
        region: 'us-east-1'

# Disaster recovery
disasterRecovery:
    enabled: true
    replication:
        enabled: true
        regions:
            - 'us-west-2'
            - 'eu-west-1'

# Certificate management
certManager:
    enabled: true
    issuer:
        name: letsencrypt-prod
        email: admin@quantumvest.com
        server: https://acme-v02.api.letsencrypt.org/directory

# Vault integration
vault:
    enabled: true
    address: 'https://vault.quantumvest.com'

# External services
externalServices:
    enabled: true
    services:
        - name: payment-gateway
          url: 'https://api.stripe.com'
        - name: market-data
          url: 'https://api.marketdata.com'
        - name: notification-service
          url: 'https://api.sendgrid.com'

# Development and testing
development:
    enabled: false
    debug: false
    mockServices: false

# Compliance settings
compliance:
    sox:
        enabled: true
        auditLogging: true

    pciDss:
        enabled: true
        level: 1

    gdpr:
        enabled: true
        dataRetention: '7y'

    iso27001:
        enabled: true
        controls: true

# Performance tuning
performance:
    caching:
        enabled: true
        ttl: '1h'

    compression:
        enabled: true

    cdn:
        enabled: true
        provider: 'cloudflare'

# Resource quotas
resourceQuota:
    enabled: true
    hard:
        requests.cpu: '20'
        requests.memory: '40Gi'
        limits.cpu: '40'
        limits.memory: '80Gi'
        persistentvolumeclaims: '20'

# Limit ranges
limitRange:
    enabled: true
    limits:
        - type: Container
          default:
              cpu: '500m'
              memory: '1Gi'
          defaultRequest:
              cpu: '100m'
              memory: '256Mi'
          max:
              cpu: '4'
              memory: '8Gi'
          min:
              cpu: '50m'
              memory: '128Mi'

# Node affinity and tolerations
nodeSelector: {}

tolerations: []

affinity:
    podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
            - weight: 100
              podAffinityTerm:
                  labelSelector:
                      matchExpressions:
                          - key: app
                            operator: In
                            values:
                                - quantumvest
                  topologyKey: kubernetes.io/hostname
